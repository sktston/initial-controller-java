<!DOCTYPE html>
<html lang="ko">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-serialize-object/2.5.0/jquery.serialize-object.min.js"></script>

<!-- get parameters -->
<script type="text/javascript">
    var Request = function() {
        this.getParameter = function(name) {
            var rtnval = '';
            var nowAddress = unescape(location.href);
            var parameters = (nowAddress.slice(nowAddress.indexOf('?') + 1,
                    nowAddress.length)).split('&');
            for (var i = 0; i < parameters.length; i++) {
                var varName = parameters[i].split('=')[0];
                if (varName.toUpperCase() == name.toUpperCase()) {
                    rtnval = parameters[i].split('=')[1];
                    break;
                }
            }
            return rtnval;
        }
    }
    var request = new Request();
</script>

<!-- json submit -->
<script>
    function ajax_send(frm){
        var formData = $('#dataForm').serializeObject();
        $.ajax({
            url : '/web-view/submit',
            type : 'POST',
            contentType : 'application/json',
            data : JSON.stringify(formData),
            success : function(data){
            },
            error: function(xhr, status, error){
                alert(status);
            }
        });

        var userAgent = navigator.userAgent.toLowerCase();
        if (userAgent.search("android") > -1) {
            Android.failVC ();
        }
        else {
            webkit.messageHandlers.callbackHandler.postMessage("failVC");
        }

        return false;
    }
</script>


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width" />
    <title>web-view form</title>
    <style>
      * {
        font-size: 16px;
        font-family: Consolas, sans-serif;
      }
    </style>
</head>

<body>
<center>
    <form id="dataForm">
        <input type="hidden" name="connectionId" id="connectionId" value="connectionIdValue" />
        <script>
        var connectionIdValue = request.getParameter('connectionId');
        document.getElementById("connectionId").value = connectionIdValue
        </script>
        <p>Web View 테스트 화면 입니다. VC를 발급 받기 위해서는 아래 버튼을 클릭하세요. 화면은 자동 종료 됩니다.</p>
        <div>
            <p>
                <input type="radio" id="itemChoice1"
                       name="selectedItemId" value="item1Id" checked>
                <label for="itemChoice1">2021.01.05 토익성적 증명서</label>
            </p>
            <p>
                <input type="radio" id="itemChoice2"
                       name="selectedItemId" value="item2Id">
                <label for="itemChoice2">2021.03.05 토익성적 증명서</label>
            </p>
            <p>
                <input type="radio" id="itemChoice3"
                       name="selectedItemId" value="item3Id">
                <label for="itemChoice3">2020.04.05 토익성적 증명서</label>
            </p>
        </div>
        <div>
            <input type="button" onclick="ajax_send()" value="발급요청">
        </div>
    </form>
</center>
</body>

</html>
