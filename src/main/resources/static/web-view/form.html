<!DOCTYPE html>
<html lang="ko">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<!-- get parameters -->
<script type="text/javascript">
    var Request = function() {
        this.getParameter = function(name) {
            var rtnval = '';
            var nowAddress = unescape(location.href);
            var parameters = (nowAddress.slice(nowAddress.indexOf('?') + 1,
                    nowAddress.length)).split('&');
            for (var i = 0; i < parameters.length; i++) {
                var varName = parameters[i].split('=')[0];
                if (varName.toUpperCase() == name.toUpperCase()) {
                    rtnval = parameters[i].split('=')[1];
                    break;
                }
            }
            return rtnval;
        }
    }
    var request = new Request();
</script>

<!-- json submit -->
<script>
    function ajax_send(frm){
        var formData = $('#dataForm').serializeObject();
        $.ajax({
            url : '/web-view/submit',
            type : 'POST',
            contentType : 'application/json',
            data : JSON.stringify(formData),
            success : function(data){
            },
            error: function(xhr, status, error){
                alert(status);
            }
        });

        return false;
    }
</script>

<!-- cancel button -->
<script>
    function cancel(){
        //initial app에서 web_view 화면을 즉시 종료 하는 code
        var userAgent = navigator.userAgent.toLowerCase();
        if (userAgent.search("android") > -1) {
            Android.failVC ();
        }
        else {
            webkit.messageHandlers.callbackHandler.postMessage("failVC");
        }
    }
</script>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>web-view form</title>
    <style>
body {font-family: Arial, Helvetica, sans-serif;}

/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
</style>
</head>

<body>
<center>

    <input type="hidden" name="connectionId" id="connectionId" value="connectionIdValue" />
    <script>
        var connectionIdValue = request.getParameter('connectionId');
        document.getElementById("connectionId").value = connectionIdValue
        </script>
    <p>Web View 테스트 화면 입니다. VC를 발급 받기 위해서는 영어 이름을 입력하고 아래 버튼을 클릭하세요. 화면은 자동 종료 됩니다.</p>
    <div>
        <p>
            <input type="radio" id="itemChoice1"
                   name="selectedItemId" value="20190105" checked>
            <label for="itemChoice1">2019.01.05 토익성적 증명서</label>
        </p>
        <p>
            <input type="radio" id="itemChoice2"
                   name="selectedItemId" value="20200305">
            <label for="itemChoice2">2020.03.05 토익성적 증명서</label>
        </p>
        <p>
            <input type="radio" id="itemChoice3"
                   name="selectedItemId" value="20210405">
            <label for="itemChoice3">2021.04.05 토익성적 증명서</label>
        </p>
    </div>
    <p>
        English name :
        <input type="text" id="eng_name" name="eng_name"> <br>
    </p>
    <!-- Trigger/Open The Modal -->
    <button id="myBtn">Open Modal</button>

    <!-- The Modal -->
    <div id="myModal" onclick="ajax_send()" class="modal">

        <!-- Modal content -->
        <div class="modal-content">
            <button class="btn btn-primary" type="button" disabled>
                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                Loading...
            </button>
        </div>
    </div>

    </div>
    <script>
// Get the modal
var modal = document.getElementById("myModal");

// Get the button that opens the modal
var btn = document.getElementById("myBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal
btn.onclick = function() {
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>
    <p></p>
    <div>
        <button type="button" onclick="cancel()" value="취소">취소</button>
    </div>

</center>
</body>

</html>